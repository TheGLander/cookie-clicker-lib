{"version":3,"file":"index.js","sources":["../src/helpers.ts","../src/injects.ts","../src/index.ts"],"sourcesContent":["export type CommonString = string | Function\nexport function escapeRegExp(str: string): string {\n\treturn str.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, \"\\\\$1\")\n}\nexport function getValue(value: CommonString): string {\n\tif (value instanceof Function) return value()\n\treturn value\n}\nexport function injectCode({\n\tfunc,\n\tsource,\n\ttarget,\n\twhere,\n}: {\n\tfunc: Function\n\tsource?: string\n\ttarget: string\n\twhere: \"before\" | \"replace\" | \"after\"\n}) {\n\tlet newFuncStr = func.toString()\n\tlet sliceMode = source === undefined\n\tlet regex: RegExp\n\tif (!sliceMode) {\n\t\tsource = getValue(source)\n\t\tregex = new RegExp(escapeRegExp(source), \"g\")\n\t}\n\ttarget = getValue(target)\n\tlet findStart = /\\)\\s+{/\n\n\tswitch (where) {\n\t\tcase \"before\":\n\t\t\tif (sliceMode) newFuncStr = newFuncStr.replace(findStart, `) {${target}`)\n\t\t\telse newFuncStr = newFuncStr.replace(regex, `${target}${source}`)\n\t\t\tbreak\n\t\tcase \"replace\":\n\t\t\tif (sliceMode) newFuncStr = `${target}`\n\t\t\telse newFuncStr = newFuncStr.replace(regex, `${target}`)\n\t\t\tbreak\n\t\tcase \"after\":\n\t\t\tif (sliceMode) throw new Error(\"Yikes, can't add to end!\")\n\t\t\telse newFuncStr = newFuncStr.replace(regex, `${source}${target}`)\n\t\t\tbreak\n\t\tdefault:\n\t\t\tthrow new Error('where Parameter must be \"before\", \"replace\" or \"after\"')\n\t}\n\tlet newFunc = new Function(`return (${newFuncStr})`)()\n\tnewFunc.prototype = func.prototype\n\treturn newFunc\n}\n","import { injectCode } from \"./helpers\"\n\ndeclare global {\n\tinterface Window {\n\t\tGame: any\n\t\tCCL: any\n\t}\n}\nexport function main() {\n\tclass Injection {\n\t\tconstructor(\n\t\t\tpublic value: string,\n\t\t\tpublic defValue: any,\n\t\t\tpublic func?: Function\n\t\t) {}\n\t}\n\tlet dummy = {}\n\tconst injections: Array<Injection> = [\n\t\tnew Injection(\"customMenu\", [], () => {\n\t\t\twindow.Game.UpdateMenu = injectCode({\n\t\t\t\tfunc: window.Game.UpdateMenu,\n\t\t\t\twhere: \"before\",\n\t\t\t\ttarget: `\n\t\t\t\t\t// CCLib\n\t\t\tswitch (Game.onMenu) {\n\t\t\t\tcase \"prefs\":\n\t\t\t\t\tfor(const i in CCL.customOptionsMenu) CCL.customOptionsMenu[i]();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"stats\":\n\t\t\t\t\tfor(const i in CCL.customStatsMenu) CCL.customStatsMenu[i]();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"log\":\n\t\t\t\t\tfor(const i in CCL.customInfoMenu) CCL.customInfoMenu[i]();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfor(const i in CCL.customMenu) CCL.customMenu[i]();`,\n\t\t\t})\n\t\t}),\n\t\tnew Injection(\"customOptionsMenu\", []),\n\t\tnew Injection(\"customStatsMenu\", []),\n\t\tnew Injection(\"customInfoMenu\", []),\n\t\tnew Injection(\"customInfoMenu\", []),\n\t\tnew Injection(\"customLoad\", [], () => {\n\t\t\twindow.Game.LoadSave = injectCode({\n\t\t\t\tfunc: window.Game.LoadSave,\n\t\t\t\tsource: \"if (Game.prefs.showBackupWarning==1)\",\n\t\t\t\twhere: \"before\",\n\t\t\t\ttarget: `\n\t\t\t// CCLib\n\t\t\tfor(const i in CLL.customLoad) CLL.customLoad[i](); `,\n\t\t\t})\n\t\t}),\n\t]\n\tinjections.forEach(inject => {\n\t\tdummy[inject.value] = inject.defValue\n\t\tif (inject.func) inject.func()\n\t})\n\treturn dummy\n}\nexport function a() {}\n","import { injectCode } from \"./helpers\"\nimport { main } from \"./injects\"\ndeclare global {\n\tinterface Window {\n\t\tGame: any\n\t\tCCL: any\n\t\tCCLInit: boolean\n\t}\n}\nlet lol = 6\nlet custom = {}\nif (!window.CCLInit) {\n\twindow.CCLInit = true\n\tcustom = main()\n}\nlet master = {\n\t...custom,\n\tlol,\n\tinjectCode,\n}\nexport default master\n"],"names":[],"mappings":"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"}